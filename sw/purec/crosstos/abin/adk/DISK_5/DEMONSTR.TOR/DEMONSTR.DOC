





                                 DEMONSTRATOR


                                   Chapter 1

                                  An Overview


                                 Introduction

    Demonstrator is a comprehensive tool for creating and playing
    self-running demos and tutorials for the Atari ST and Mega series of
    computers. With it, you create mouse/keyboard Macros, explanatory
    Tutorial screens and pacing Timers (collectively known as Scenes). You
    create these Scenes within the context of your application program and
    then assemble the Scenes graphically into a complete demo. Demonstrator
    controls application programs transparently; you can create demos for
    programs without modifying the programs in any way. When a Macro is
    played back, it appears to the application program that a well
    experienced user is controlling the mouse and keyboard. When Tutorial
    screens are drawn and then removed from the screen, the background
    underneath them is saved and restored so the application program
    doesn't need to do any redraws. In fact the program remains completely
    unaware that anything has occurred at all.

    There are two parts to Demonstrator; the Builder module and the
    Playback module. The Builder module is used to create, edit and test
    demos. The Playback module is used only to play them back. The Playback
    module (DEMOPLAY.PRG) may be freely distributed with your demos.
    Instructions for the Playback module are in Appendix B.

    Demonstrator works with a wide variety of application programs whether
    they be GEM based (.PRG and .APP) or not (.TOS and .TTP). It works in
    all three of the ST and Mega screen resolutions as well as with the 19"
    Moniterm monochrome monitor. However, it should be noted that a demo
    created in one resolution probably won't work in another.


                                  The Desktop

    The demo builder's desktop consists of several distinct areas:

        Program Startup Icon
        Parts Box
        Menu Bar
        Demo File Name
        Tools Box
        Vertical and Horizontal Scroll Bars
        Work Area

    The exact layout of the desktop may vary depending on the selected
    resolution, but the essential parts remain the same. The following is a
    brief description of the desktop:













    The Menu Bar is the same as that normally found in GEM programs. Each
    of the options in the menus has a keyboard equivalent, that is, a
    combination of keys which also select that option. The carat '^' symbol
    means hold the Control key down and then press the appropriate letter.
    For example, the Save option in the File menu can be selected by
    pressing the keys Control and S simultaneously (^S). The black
    rectangle with a white diamond inside it means hold the Alternate key
    down and then press the appropriate letter. For example, the Cut option
    in the Edit menu can be activated by pressing the keys Alternate and C
    simultaneously.

    The Demo File Name indicates the full name, including drive and folder,
    of the demo file currently being used. Initially the file name is
    'Untitled,' however, this can be changed by using the Save As...
    option.

    The Parts Box contains icons representing the various Scene types that
    are used to construct a demo. Each of the Scene types is described in
    detail in the next chapter.

    The Tools Box contains the clip board and the trash can. The clip board
    is used to temporarily save Scenes or Options which have been either
    cut or copied from the demo. The contents of the clip board can later
    be pasted back into the demo. The trash can is used to delete Scenes or
    Options.

    The Work Area is where the Scenes are assembled into a demo. As the
    demo gets larger and more Scenes are placed, the scroll bars may be
    used to move around in the work area in order to view the desired
    portion of the demo. In low resolution, the work area becomes so small
    that it is difficult to use. This is not a serious problem however,
    since a demo can be created in one resolution and edited in another.

    The Program Startup Icon is used to represent the application program
    which is being demonstrated. Scenes placed after the Program Startup
    Icon indicate actions which are to be taken immediately after starting
    up the application program. Typically, this consists of at least one
    timer Scene which delays the start of the demo for a number of seconds
    until the application program is fully loaded and initialized.


                            The Structure of a Demo

    A demo consists of from 0 to 15 Options (represented by Menu Item
    Icons) each followed by 1 or more Scenes (Macros, Tutorials and
    Timers). Macros are recordings of keyboard and mouse activity. They are
    created within the context of the application program as described in
    Chapter 3.

    Tutorials are boxes of text which the demo displays on the screen while
    the application program is running. They explain to the user what is
    happening during the demo. Like Macros, Tutorials are created within
    the context of the application program as described in chapter 3.













    Timers provide a pause in the demo, that is, a fixed time delay when
    the application program is not being controlled by a Macro and a
    Tutorial is not being displayed. They are typically used to wait for
    some function of the application program to complete such as loading a
    file.


                                 The Demo Menu

    Each Menu Item Icon placed in the Work Area represents the start of an
    Option of the demo. Menu Item Icons are always placed at the far left
    hand side of the work area. When opened (either by double clicking on
    them, single clicking on them and selecting Open from the File menu, or
    possibly automatically when they are placed) they provide a dialog in
    which you specify a line of text and an optional icon name. The text
    associated with the Menu Item appears as an Option on the Demo Menu.
    The Scenes placed to the right of the Menu Item Icon are executed in
    order whenever that Option is selected from the Demo Menu. Whenever the
    end of an Option is reached, the Demo Menu is displayed again until
    another Option is selected (either manually by the user or
    automatically by Demonstrator).

    There are as many Options on the Demo Menu as there are Menu Item Icons
    in the Work Area (to a maximum of 15). Demonstrator automatically
    formats the Demo Menu to accomodate the number of Options you have
    created.

    If no Menu Item Icons are placed and all of the Scenes (Macros,
    Tutorial and Timers) which are placed follow the Program Startup Icon,
    the demo runs without a Demo Menu. After the program is started,
    Demonstrator executes each of the Scenes placed to the right of the
    Program Startup Icon in turn until it reaches the last Scene, and then
    the demo ends. In this way you can elect to have a Demo Menu or not
    depending on which is more suitable for your purpose.

    It should be noted that each of the Options on the Demo Menu should be
    self-contained. That is, each one should be able to run independently
    without a prior Option having to be run first. For example, let's say
    you are creating a demo for a word processor.  You have made Option 1
    load a text file and Option 2 do some editing on that text file.
    Obviously, if the user selects Option 2 before Option 1 has run, there
    is no text to edit and Option 2 is meaningless. A possible solution to
    this situation is to have the text file loaded as part of the Startup
    sequence and hence the editing Option always has text to work with.
    Note, however, that the editing Option (as well as all the other
    options) should leave the text file the way they found it or else a
    subsequent selection of the editing Option may not find the paragraphs
    etc., in the expected place. Careful design permits the user to select
    any Option at random, succesfully.

    To specify the title and subtitle that you want on your Demo Menu,
    select Menu Options... from the Options menu (or press Control M). A
    dialog box appears providing space to enter a title line and subtitle
    and set 3 options.














    Automatic Selection Time

    Demonstrator waits a fixed amount of time for the user to select an
    Option from the menu. If no Option is selected within the allotted
    time, Demonstrator automatically selects the Option immediately
    following the one just played. You can change the amount of time that
    the program waits for the user by entering a new value in this dialog.

    Looping the Demo

    Normally, assuming no user selections, Demonstrator plays each Option
    on the Demo Menu in turn until it reaches the end of the last Option
    whereupon the demo terminates. The last Option on any demo menu should
    be a Quit Option which terminates the application program and returns
    to the Demo Builder (or Demo Player) desktop. If the 'Continuously loop
    Demo' option is selected, instead of playing the last Option (Quit) and
    terminating the demo, Demonstrator returns to the top of the Demo Menu
    and play the first Option again. It continues to cycle through the
    Options forever or until the user selects the Quit Option manually from
    the menu.

    Disabling User Selections

    When the 'Disable user selections' option is selected, the program
    ignores any selections from the Demo Menu made by the user. If the
    'Loop' option is not selected, this means that the demo plays through
    each Option once in order and then terminate. If the 'Loop' option is
    selected the demo plays forever. This option may be used for demos
    whose Options may not be selected at random since they are not
    self-contained as described above.


                                   Chapter 2

                                    Scenes

    This chapter describes the various Scene types and the options you have
    when you place them. By default, the Scenes are opened as they are
    placed, however this can be changed using the Set Preferences... (^P)
    option. If you wish to open the Scenes after they have been placed,
    either double click on them or click on them once to select them and
    then choose Open... from the Edit menu (or press ^O).

    Initially, you have not created any Macro or Tutorial Scenes to place,
    however, there is always an EMPTY macro and an EMPTY Tutorial. These
    Empty Scenes are used as place holders so you can decide the structure
    of your demo before actually creating any Scenes. In practice, it is
    often easier to create the Scenes and then place them but the Empty
    Scenes allow you to do it the other way around if you wish.

    Each Macro and Tutorial Scene you create (see Chapter 3 for how to
    create Scenes) may be placed as many times as desired. If you have












    created a Scene which takes say 2k it doesn't take up twice that amount
    (4k) if you place it twice. The actual information for the Scene is
    kept only once, however, the options for that Scene (e.g. playback
    speed for Macros) may vary with each placement.


                                    Macros

    Macros are real-time recordings of mouse and keyboard activity. In
    fact, Macros can store any packets sent by the ST or Mega's Intelligent
    Keyboard processor, even joystick information, but in practice the
    mouse and keyboard information is of most use. When you open a Macro
    Icon which you have placed, an item selector appears allowing you to
    select a name for the Scene from the list of Macros you have created.

    The Macro name selector functions much like the standard GEM File
    Selector. You can scroll through the list of names using the scroll
    arrows or the scroll bar and then select a name by clicking on it.
    Double clicking on a name is equivalent to selecting the name and then
    clicking on the OK button. In addition to selecting a name for the
    Macro in this dialog, you can determine the speed at which the Macro is
    played back. The default speed is Normal (i.e. the same speed at which
    the Macro was recorded) but you can choose to play it 2, 4 or 8 times
    faster or 2, 4 or 8 times slower.

    In practice, playing a Macro back too quickly is of little use if the
    Macro uses mouse movements. GEM may misinterpret the movements or miss
    mouse clicks entirely. Also, playing back a Macro too slowly when it
    uses mouse double clicks, may result in GEM interpreting the action as
    two separate single clicks. Macros which restrict themselves to
    keyboard recordings only are not subject to this limitation but
    remember to provide sufficient time for the screen to update as a
    result of keyboard activity.


                                   Tutorials

    Tutorials are arbitrarily sized boxes of text which can be displayed on
    the screen while the demo is running. They inform the user of what is
    going on throughout the demo. Without tutorials, demos would consist
    only of mysterious mouse and keyboard movements which would quickly
    lose the viewer. For information oncreating tutorials refer to Chapter
    3.

    When a tutorial is opened, an item selector appears allowing you to
    choose a name for the Scene from a list of Tutorials you have created.

    The Tutorial selector is quite similar to the Macro selector except
    that instead of choosing a playback speed, you can choose from three
    different ways of displaying the Tutorial.

    The first method is to display the Tutorial for a fixed number of
    seconds. While the Tutorial is being displayed, the demo and the
    application program are static. This is the most common and easiest to












    use of the display methods.

    The second method of displaying a Tutorial, is to display it for a
    number of Scenes. For example if you choose to display a Tutorial for 1
    Scene, and the Scene following the Tutorial in the demo is a macro,
    then the Tutorial remains on the screen for the duration of the Macro.
    This, unfortunately, has a few pitfalls. Since the application program
    is unaware that the Tutorial is on the screen, it could inadvertently
    draw over the Tutorial. Also, since the Tutorial is unaware that it has
    been drawn on, it incorrectly restores the background underneath itself
    when it is removed from the screen. In practice though, this poses
    little problem. Simply ensure that the Tutorial is placed over a
    portion of the screen that is not drawn on by any of the activities
    taking place for the duration of its display. If this is not possible
    e.g. the whole screen is being scrolled, then you have to use one of
    the other methods of display. Note that this restriction does not apply
    to the mouse arrow due to its method of display and the fact that it is
    turned off by the Dmonstrator while the Tutorial is being displayed or
    the background underneath it restored.

    The third method of display, is to display the Tutorial until the
    Return key is pressed. As with the first method, both the demo and the
    application program are static during the display. This method is of
    less use than the first two since the demo remains static unless
    someone is available to press the Return key (contrary to the purpose
    of a self-running demo). Nevertheless, it has the advantage of allowing
    the user to read the information on the tutorial at his own speed
    rather than at some predetermined rate.

    As many as 20 Tutorials can be displayed at the same time, their
    combined areas, however, cannot total more than the screen size
    (somewhat less in the case of a 19" monitor). You could, for instance,
    display one Tutorial for three Scenes where the next three Scenes are a
    Tutorial displayed for 6 seconds, a Macro and another Tutorial
    displayed for 6 seconds. The effect would be for the first two
    Tutorials to appear on the screen, after 6 seconds the second Tutorial
    would disappear and the Macro would begin. After the Macro completed,
    the third Tutorial would be displayed and then, after 6 seconds, the
    first and the third Tutorials would be remove from the screen. As you
    can see, this gives you a significant degree of control over what
    happens when and in what sequence Tutorials occur.


                                    Timers

    Timers provide a pause in the demo during which some action can be
    completed by the application program. Unlike Macros and Tutorials,
    Timers do not have to be created. Simply place Timer Icons as desired
    and open them to change their delay durations.

    Typical uses for Timers include waiting for files to load, printouts to
    finish, etc. Another common use is to wait for a number of seconds
    while the user reads a Tutorial. For example, if you want a Tutorial
    displayed while a Macro is running but the Macro is too short to give












    the user time to read the Tutorial, simply make the Tutorial display
    for 2 Scenes where the first is a Timer giving the user a chance to
    start reading and the second is the Macro. This can have a more
    pleasing effect than just displaying the Tutorial for a number of
    seconds and then running the Macro.


                                   Chapter 3

                                Creating a Demo


                    Specifying the Application Program Name

    The first thing to do when creating a demo is specify the name of the
    application program for which you are creating the demo. This may be
    done by either double clicking on the Program Startup Icon or by
    selecting it by clicking on it once and then choosing Open... from the
    Edit menu.

    In the dialog, specify the name of the application program and its
    type. If you are demonstrating a .TTP program, you may optionally enter
    a list of parameters to be passed to the program on startup. When you
    are finished, click on OK. The name of the application program now
    appears under the Program Startup Icon.

    Note: The application program must be in the same folder from which you
    invoked the demo builder (i.e. the current directory).


                                Creating Scenes

    The next step is to create the Macro and Tutorial Scenes which make up
    your demo. You do not have to create all of your Scenes at once and in
    fact it is probably best to proceed one Option at a time. Often it is
    easiest if you create all the Macro Scenes for an Option, place them
    and then test the Option for continuity by running that part of the
    demo. You can then go back and add any Tutorial Scenes you want and
    then re-test the Option.

    Creating Macros and Tutorials is done within the context of the
    application program for which the demo is being created. To do this,
    select Create Scene... from the Demo menu (or press ^C). The
    application program loads normally and then you can start creating your
    Scenes. When you are done, exit the application as you would normally
    and you are returned to the Demo Builder's desktop.


                                Creating Macros

    To begin recording a Macro, press the keys Control-Alternate-Left
    Shift-F1. This may seem like a strange combination of keys to press but
    in order for Demonstrator to work with as many programs as possible
    without interfering, a key combination had to be chosen that no program












    would likely use in its normal course of operation.

    Once you have done this, the application program is temporarily frozen
    and an information box appears, instructing you to locate the mouse at
    the desired starting position and then press Return. Once you have done
    this, the application program is unfrozen and every action you take
    with the mouse, keyboard, joysticks etc. are be recorded in real-time.
    The application program should function normally, so just operate it as
    you usually do.

    When you have finished recording the Macro, press the keys
    Control-Alternate-Left Shift-F2. The program is again temporarily
    frozen and a dialog appears asking you to enter a name for the Macro.
    If you choose a name which has already been used, you are asked if you
    wish to replace the old Macro (press Return) or choose another name
    (press ESC). If you create a Macro which you don't want, you can Erase
    it later when you return to the Demo Builder's desktop by selecting
    Erase Scene... from the Demo menu (or pressing ^E).


    Playing Back Macros

    If you want to play back a Macro, press the keys Control-Alternate-Left
    Shift-F3. You are asked to enter the name of the Macro which you have
    recorded, and then, after pressing Return, the Macro begins playing
    back. While a Macro is playing, it has sole control of the application
    program and the mouse and keyboard are inactive.

    When a Macro is played back, the mouse is initially put at the same
    location that it was when the Macro was recorded. All of the ensuing
    mouse movements are relative to this starting location. For this
    reason, it is best to get a Macro to start recording from roughly the
    same position as the previous Macro ended. If you don't do this, the
    Macros still run properly, however, the mouse arrow may appear to skip
    around on the screen between one Macro and the next. Note that while
    Tutorials are being displayed, the mouse arrow is turned off, so a lack
    of continuity in the flow of the mouse arrow is less apparent anyway.

    It is important to remember that a Macro is just a real-time recording
    of mouse movements, button clicks, key presses, and key releases.
    Macros are not intelligent. In order for a Macro to work properly, the
    application program must be in the same state each time the Macro is
    run. For example, let's assume you have recorded a Macro for a drawing
    program which resizes a circle on the screen. It is important that the
    circle be in the same place each time the Macro is run. If it isn't,
    the mouse arrow will still move as it was recorded, but it obviously
    will miss the circle.


                                 Tutorial Mode

    You can elect to create, edit or display Tutorials at any time while in
    Create Scene. To do this, you must enter Tutorial mode by pressing
    Control-Alternate-Left Shift-F4. At this time, the application program












    is frozen and a Tutorial mode menu is displayed on the screen. When you
    are done working with Tutorials press the key F10. Demonstrator exits
    Tutorial mode and the application program is unfrozen, ready for you to
    create more Macros, exit back to the Demo Builder's dekstop, etc.

    Creating/Editing Tutorials

    To create a new Tutorial or Edit an existing one, press F1 from
    Tutorial mode. You are prompted for the name of a Tutorial. If you have
    already created a Tutorial with that name, the Tutorial is displayed on
    the screen and you can begin editing it. If you choose a name which you
    haven't used before, you are asked if you wish to create a new Tutorial
    with that name. If you don't want to create one, press the ESC key. If
    you do, press the Return key. Now position the mouse roughly where you
    want the Tutorial to appear and press and hold the left mouse button.
    The outline of a small box appears. Drag the box's corner until it
    reaches the desired size and proportions and then release the mouse
    button. An empty white Tutorial box appears with a text cursor in the
    top left corner.

    Adding and Editing Text

    To add text to a new Tutorial, simply start typing. Demonstrator
    functions like a simple word processor and wraps the words
    automatically as you reach the end of a line. If you want to start a
    new paragraph, press the Return key. The text is all formatted so that
    it is left justified (ragged right). If you want special formatting
    e.g., centered text, you have to add spaces yourself. Remember that if
    you resize the Tutorial you may have to alter the number of blanks you
    used when centering lines.

    Certain special characters are available from the system character set.
    The most useful of these are the up, down, left and right arrows
    accessed by pressing the keys Control A through Control D.

    Editing text is done much as you would expect. The arrow keys move the
    cursor up, down, left and right, the Backspace key deletes the
    character behind the cursor and the Delete key deletes the character
    underneath the cursor.


    Changing Styles

    Demonstrator allows two different styles for text; bold and normal. To
    switch to bold font from normal press F3. Anything you type appears in
    bold letters. When you want to switch back to normal font press F3
    again.

    Moving and Resizing Tutorials

    To move an existing or newly created Tutorial, place the the mouse
    arrow anywhere within the Tutorial box and press and hold the left
    mouse button. An outline of the Tutorial box appears which you can then
    drag to a new location on the screen. When you have positioned the












    outline to suit your needs, release the mouse button and the Tutorial
    disappears from its old location and reappear where the outline was
    placed. You can only position the Tutorial so that it is completely on
    the screen i.e. you can't place it so that half of the Tutorial is off
    of the screen.

    To resize a Tutorial, place the mouse arrow over the bottom right hand
    corner of the Tutorial and press and hold the left mouse button. Then
    drag the corner in any direction to resize the Tutorial and release the
    mouse button. The Tutorial redraws in its new size and all of the text
    in the Tutorial flows to fill the new box. When you are resizing a
    Tutorial, Demonstrator will not let you make the box smaller than the
    minimum size required to fit all of its text.


    Exiting Tutorial Edit

    When you have completed editing of the Tutorial and have positioned and
    sized it to your needs, press F2. If it is a newly created Tutorial, it
    is saved and you return to the Tutorial Mode menu. If you have edited
    an existing Tutorial, you are first asked to confirm that you want to
    save your changes. To confirm, press the Return key, otherwise press
    ESC.

    Incidentally, if, while editing a Tutorial, you can't remember which
    keys do what, press the Help key. An information box appears informing
    you F2 exits and F3 toggles between bold and normal style text. To get
    rid of the Help box press Return.


    Displaying and Closing Tutorials

    On occasion, it may be helpful to create or edit a Tutorial while a
    different one is being displayed. Also, you may want to record a Macro
    while a particular Tutorial is showing so that you can ensure that the
    Macro doesn't accidentaly do something which might draw over the
    Tutorial.

    For this reason, Demonstrator allows you to display up to 20 tutorials
    at a time, either while editing or while recording Macros. To do this,
    from Tutorial mode press the key F4. You are asked for the name of the
    Tutorial you wish to display, and then that Tutorial are drawn on the
    screen. You can now edit a Tutorial by pressing F1, display another
    Tutorial by pressing F4 or exit Tutorial mode by pressing F10 and
    proceed to record a Macro.

    If the Tutorial mode menu box appears over a Tutorial which you have
    displayed and it is interfering with your work, press the Help key and
    the menu moves to a new location. Originally, the menu appears in the
    center of the screen. The first time you press help, it moves to the
    top left of the screen. Subsequent presses move the menu to the top
    right, bottom left and bottom right corners of the screen. If you press
    Help yet again, the menu disappears altogether. A subsequent press
    starts the menu in the center again and so on.













    If you want to close a Tutorial which is being displayed, go to
    Tutorial mode and press F5. Enter the name of the Tutorial and press
    return. The Tutorial is removed from the screen and the background that
    was underneath it when it was first opened is restored. If you have
    overlaping Tutorials displayed, there may be a problem with closing one
    that is underneath another as the background is restored incorrectly.
    For this reason, every time you close a Tutorial, Demonstrator
    automatically closes all Tutorials that were displayed after the one
    you are closing. It then reopens those Tutorials in the same order they
    were placed, thus ensuring the background is maintained correctly.

    Although you can have as many as 20 Tutorials open at one time, their
    total area must not add up to more than that of the screen. On the 19"
    Moniterm monitor, this is further restricted to a total area no larger
    than 640x400 pixels. The reason for this is that the amount of memory
    used to save and restore the background is enough only for an area
    equal to that of the screen. If there is not enough memory to open a
    Tutorial you are informed that there is not enough Blit memory.


    Returning to The Desktop

    Once you have finished creating some Scenes, it is time to return to
    the Demo Builder's desktop so you may start placing the Scenes. To do
    this, simply exit the application program as you would normally and you
    return to the Demo Builder.

    It is important to note that if you are in the process of recording a
    Macro when you exit the application program, the Macro is terminated
    and you are asked to name it. The reason for this is so that you can
    successfully create a 'Quit' macro which terminates the application
    program and the demo. This is especially important when considering
    playing a list of demos using the Demo Player. In order for each demo
    to be able to run, the preceeding demo must at some point terminate its
    application program and return to the Demo Player.


                                Placing Scenes

    Placing Scenes is simply a matter of draging the appropriate icon from
    the tool box to the desired location in the work area. If you are
    planning on having a Demo Menu, first drag a Menu Item icon into the
    work area. It places itself at the left of the first available row in
    the work area.

    By default, the Scenes open automatically as you place them. When the
    Menu Item opens, enter a descriptive line of text for that menu Option
    as described in Chapter 1. Now you can start placing the Scenes you
    have created (as well as Timers) in the order required for the Option.
    As each Scene opens, specify the name of the Tutorial or Macro and the
    Scene's options as described in Chapter 2.

    If you accidentaly place a Scene in the wrong place, you can drag it to












    another location or drag it to the Trash Can in the tools box to delete
    it. For more information on arranging Scenes and editing, refer to
    Chapter 4.

    If you have recorded Scenes for more than one Option, you can proceed
    to place the Menu Items and related Scenes for the other Options. You
    can also place any Scenes which you want executed immediately after the
    application program is loaded, after the Program Startup Icon. At the
    very least you need one timer Scene after the Program Startup in order
    to give the application program a chance to initialize before the demo
    takes over.

    You should also at this time select Menu Options... from the Options
    menu and specify a title (and optionally a subtitle) for your Demo
    Menu. You can also choose to loop the demo but remember, the last
    Option on the menu should be a 'Quit' Option.

    If you are not going to use a Demo Menu, simply place all the Scenes in
    the order required, after the Program Startup Icon.


                               Running The Demo

    You are now ready to test your demo. To do this, select Run Demo...
    from the Demo menu. The application program is started, the startup
    sequence executed and then the Demo Menu appears.

    You can either wait for the Options to be selected automatically in
    turn by Demonstrator or you can select them yourself. Run through each
    Option a couple of times to make sure it is working correctly.

    If you want to interrupt the demo for some reason, press Control C
    while a Tutorial is being displayed. This only works for Tutorials that
    are displayed for a fixed amount of time or Tutorials that are
    displayed until Return is hit. It does not work while a Macro or Timer
    is running even if a Tutorial is being displayed at that time.

    If you want to restart the demo from where it left off, press the keys
    Ctrl-Alt-Left Shift-F5. Remember, though, that if you have done
    anything to the application program that the demo is not expecting, the
    remainder of the demo may not work properly.

    It is not always possible to guess how long a Tutorial needs to be
    displayed in order for the user to be able to read it. If you want, you
    can pause the demo during Tutorial display (unless a Macro or Timer is
    running). To do this press Control S. You can then time how long it
    takes you to read the demo (then add a few seconds for good measure)
    and then continue on with the demo by pressing Control Q. Don't forget
    to write down how long it took you to read it and later open the Scene
    and change its display time.

    If you have already created your 'Quit' Option, Demonstrator returns
    back to the Demo Builder's desktop automatically (assuming you aren't
    looping the demo). If not, you can return to the Demo Builder by












    exiting the application program normally. If you wish, however, you can
    stay in the application program and create some more Scenes before
    returning. Assuming everything is running smoothly, you can proceed to
    add more Scenes and Options until your demo is complete.


                                   Chapter 4

                                    Editing

    Editing with Demonstrator can mean several things. It can mean editing
    the playback options for a Macro or Tutorial, editing the actual Macros
    and Tutorials themselves or editing the arrangement of the Scenes which
    make up your demo. The first two types of editing are described in
    chapters 2 and 3 respectively. This chapter deals with the arranging of
    Scenes and Options in the Work Area.


                              Scenes and Options

    A Scene in this context is an icon representing a Macro, a Tutorial or
    a Timer. An Option however, consists of a Menu Item icon followed by
    one or more Scenes. The editing operations in this chapter deal with
    either Scenes or Options.

    When you want to edit an Option, you should manipulate the Menu Item
    Icon. For example if you Cut a Timer icon, you are cutting a Scene, and
    that Scene is removed from the Work Area and put on the Clip Board.
    However, if you Cut a Menu Item Icon, you are cutting an Option, and
    the entire Option (Menu Item Icon and all the Scene icons attached to
    it) is removed from the Work Area and put on the Clip Board.


                                 The Edit Menu

    The Edit Menu options only operate when there is an Active Scene. An
    Active Scene is a Scene which has been selected by clicking on it once.
    Only one Scene may be active at any time. It appears in reverse video
    so that you know it is selected. The Active Scene does not necessarily
    have to be within the visible portion of the Work Area.

    The Edit Menu items may also be selected through keyboard equivalents.
    They all use the form of pressing Alternate and then a letter. If there
    is no active Scene, the keyboard equivalents do nothing.


    Open

    The Open command (Alternate O) is used to open Scenes in order to
    change their options. In the case of Menu Items, you can specify the
    text which appears on the Demo Menu. For Macros, you can specify the
    Macro name and playback speed. For Tutorials, you can specify the name
    and method of display and for Timers you can specify the time delay
    (see Chapter 2). An alternative to using the Open command is to












    directly double click on the desired Scene.


    Cut

    The Cut command (Alternate C) is used to remove a Scene or Option (and
    all of its related Scenes) from the Work Area and place it on the Clip
    Board. If there is already something on the Clip Board, the old
    contents are lost and replaced with the Scene or Option just cut. At
    'Beginner' user level, you are warned of this before the contents are
    replaced (see Set Preferences in Chapter 6). Since the Active Scene or
    Option is the one that is cut, there is no Active Scene after this
    operation.


    Copy

    The Copy command (Alternate R) is similar to the Cut command except
    that a copy of the Active Scene or Option is placed on the Clip Board.
    The Active Scene or Option is not affected by this operation. As with
    the Cut command, the old contents of the Clip Board (if any) are lost.


    Paste

    The Paste command (Alternate P) is used to copy the contents of the
    Clip Board back into the Work Area. If the Clip Board contains a Scene,
    a copy of the Scene is pasted in immediately following the Active
    Scene. If the Clip Board contains an Option, a copy of the Option is
    placed on the row immediately after the row which contains the Active
    Scene. Using Paste from the menu or keyboard is non-destructive, i.e.
    the contents of the Clip Board remain unaltered by this command. This
    command only becomes active in the Edit Menu if there is an Active
    Scene and the Clip Board contains something.


    Delete

    The Delete command (Alternate D) is used to entirely delete the Active
    Scene or Option. Once deleted, the Scene or Option cannot be retrieved
    from the Clip Board as with the Cut command. With Macros and Tutorials,
    remember that you are not deleting the actual Macro or Tutorial itself.
    You are only deleting an icon representing the placement of the Macro
    or Tutorial. To actually delete a Macro or Tutorial (and free up the
    memory it uses) use the Erase Scene... ^E command from the Demo menu.


                            Editing With The Mouse

    All the above editing options and more can be accomplished without the
    use of the Edit Menu (or its keyboard equivalents). It is often faster
    and more convenient to edit the Scenes and Options by dragging them
    with the mouse. In the following list of mouse editing features the
    term drag means to locate the desired icon with the mouse, click and












    hold the left mouse button, drag an outline of the icon to a new
    location and then release the mouse button:

    Moving Scenes - To move a Scene from one place to another, simply drag
    it to a new location. The Scene is placed immediately after the Scene
    where you stop.

    Moving Options - To move an Option, drag the Menu Item icon to a new
    row. The Option and all of its Scenes are placed on the row immediately
    following the row over which you stopped.

    Copying Scenes - To copy a Scene, proceed in the same way as moving a
    Scene except hold down the shift key while dragging. The original Scene
    is unaffected by this operation and a copy of the Scene is placed
    immediately following the Scene over which you stopped.

    Copying an Option - Copying an Option is exactly the same as moving an
    Option except the shift key is held down. The original Option is
    unaffected and a copy of the Option is placed on the row immediately
    after the row over which you stopped.

    Cutting a Scene - To cut a Scene, drag it to the Clip Board. The old
    contents of the Clip Board (if any) are lost.

    Cutting an Option - To cut an Option, drag the Menu Item icon to the
    Clip Board. The old contents of the Clip Board (if any) are lost.

    Copying a Scene to the Clipboard - To copy a Scene to the Clip Board,
    press the shift key and drag the Scene to the Clip Board. A copy of the
    Scene is placed on the Clip Board replacing any old contents, and the
    original Scene is left intact.

    Copying an Option to the Clipboard - To copy an Option to the Clip
    Board, press the shift key and drag the Menu Item icon to the Clip
    Board. A copy of the Option is placed on the Clip Board replacing any
    old contents, and the original Option is left intact,

    Pasting a Scene - To paste a Scene from the Clip Board to the Work
    Area, drag the contents of the Clip Board to the desired location. The
    Scene is placed immediately after the Scene you stop over. Using Paste
    by dragging the Clip Board Icon is destructive, so the contents of the
    Clip Board are actually moved and not copied, leaving the Clip Board
    empty.

    Pasting an Option - To paste an Option from the Clip Board to the Work
    Area, drag the contents of the Clip Board to a new row. The Option and
    all of its Scenes are placed on the row immediately following the row
    over which you stopped. Using Paste by dragging the Clip Board Icon is
    destructive, so the contents of the Clip Board are actually moved and
    not copied, leaving the Clip Board empty.

    Pasting a Scene Non-Destructively - To paste a Scene from the Clip
    Board to the Work Area non-destructively, proceed in the same way as
    normal pasting except hold down the shift key while dragging. The Clip












    Board contents are unaffected by this operation and a copy of the Scene
    is placed immediately following the Scene over which you stopped.

    Pasting an Option Non-Destructively - Pasting an Option from the Clip
    Board to the Work Area non-destructively is exactly the same as normal
    Option pasting except the shift key is held down. The Clip Board
    contents are unaffected and a copy of the Option is placed on the row
    immediately after the row over which you stopped.

    Deleting a Scene - To delete a Scene, drag it to the Trash Can

    Deleting an Option - To delete an Option and all of its Scenes, drag
    the Menu Item icon to the Trash Can.

    Emptying the Clip Board - If you decide you don't want the contents of
    the Clip Board anymore, simply drag the contents over the Trash Can. If
    you have run out of Scene memory, it may be necessary to do this in
    order to place some more Scenes.

    Most of these editing operations are fairly obvious and with a little
    practice they are easy to master. In general, moving something is
    accomplished by draging it and copying something is accomplished by
    holding the shift key and then dragging it.


                   Erasing and Renaming Macros and Tutorials

    The edit options which we have discussed so far in this chapter deal
    with the manipulation of Scene Icons in the Work Area. However, there
    are two edit options which have only been touched on briefly. These are
    the Erasing and Renaming of the actual Macros and Tutorials
    themselves.

    To Erase a Macro or Tutorial select Erase Scene from the Demo menu (or
    press ^E). You are asked which type of Scene you want to erase, Macro
    or Tutorial. When you have made your choice, an item selector appears
    listing all the names of the Macros and Tutorials you have created.
    Select the name of the Scene that you want to erase and click on OK.

    Erasing a Scene actually erases all of the information you created,
    whether it be mouse/keyboard events for Macros or text for Tutorials,
    and frees up the memory occupied by the Scene. All of the Scenes of the
    same type (i.e., Tutorial or Macro) in the Work Area that used that
    name are renamed EMPTY. During demo playback, Empty Scenes have no
    effect except to act as place holders.

    Renaming Scenes is accomplished in a similar fashion. Select Rename
    Scene... from the Demo menu (or press ^R), specify whether you are
    renaming a Macro or Tutorial and then choose the name of the Scene from
    the item selector provided. When you click on OK, a dialog appears
    asking you for a new name for the Scene. When you rename a Macro or
    Tutorial, all the Scenes of the same name and same type that you have
    placed in the Work Area is also be renamed. The only restriction on
    naming or renaming a Scene is that it can't be called 'EMPTY' as this












    name is reserved for the placeholder Scenes. Furthermore, you cannot
    erase the Empty Scene (however you can delete any Scenes named 'EMPTY'
    in the Work Area in the usual fashion).


                                   Chapter 5

                                File Operations

    Demonstrator's file operations are all fairly obvious. They are
    accessed via the File menu or its keyboard equivalents.

    New

    The New command (Control N) erases all of the Macros and Tutorials that
    have been created, deletes all of the Scenes that have been placed,
    resets most of the user options and changes the application program
    name (and Program Startup Icon) to be "UNKNOWN". This, in effect, is
    the same thing as exiting and restarting the Demo Builder,

    Open

    The Open command (Control O) is used to load a previously saved demo
    file. The default extension for demo files is ".DMO" but it doesn't
    have to be entered.

    If you attempt to load a file that is not a proper demo file you are
    given an error message indicating there is a format error in the file.
    Also a demo file may require more memory (for Macros and Tutorials)
    than your computer has available. This, too, is an error and you
    shouldn't try to run or work with any partial demo that might have been
    loaded. The results would be at best unpredictable, at worst
    potentially disasterous.

    If you create a demo in one resolution and try to load it in another,
    you are given a warning that the demo may not run. This does not mean
    that you can't edit the Scenes (cut, copy, paste etc.) but you probably
    won't be able to run the demo or create new Scenes successfully. All
    the screen coordinates are wrong. In any case, this allows you to
    create the Scenes for a demo in low res and assemble them in medium or
    high res. This is useful since the low res Work Area is pretty small
    and can get a bit claustrophobic.

    Save

    The Save command (Control S) is used to save the demo and all of the
    Scenes which you have created. In addition to this, all of the user
    preferences and options are saved along with the demo so you can save
    your work at the end of the day and start again the next morning
    exactly where you left off without having to set up all the options
    again. The demo is saved in the current file and displayed at the top
    of the desktop window. If you should run out of disk space while saving
    an edited version of a file, make sure you find a disk where you can
    save it using the Save As command, since the original version is












    destroyed before the new version is written to disk and you no longer
    have a backup.

    Save As

    The Save As command (Control A) is identical to the save command except
    that you are asked to provide the name of the file to save you work in.
    If you specify a file which already exists, you are warned before it is
    overwritten. The initial name when you start a demo is always
    UNTITLED.DMO and you should use this command to save your demo with a
    more recognizable name.

    Delete

    The Delete command (Control X) is used to delete a disk file. This can
    be used if you have run out of room when saving a demo and have a few
    files that you don't need that can be deleted to free up some disk
    space.

    Quit

    The Quit command (Control Q) is used to exit the Demo Builder back to
    the GEM desktop. You are warned before exiting that you should save
    your work.


                                   Chapter 6

                               The Options Menu

    The Options Menu contains various commands that let you set user
    preferences and demo options and let you get more information about the
    Scenes you have created. This chapter deals with each of the options
    one by one with the exception of Menu Options... which is described
    fully in Chapter 1.

    Set Preferences

    The Set Preferences command (Control P), as its name suggests, is used
    to set various user preferences. By default, each time you place a
    Scene, it is opened so that you can set its options. If you would
    rather place them and then open them manually later, de-select the box
    marked Open Scenes as they are placed.

    When Scenes are opened, a "zoom box" expands from the icon into the
    open Scene dialog. This gives visual feedback as to which Scene was
    opened and is especially useful when the Scene is not visible in the
    Work Area. In this case, a zoom box starts from one edge of the screen
    and expands into the dialog, giving you an idea of which direction you
    should scroll in order to be able to see the icon. The zooming process,
    however, takes time and if you find the delay annoying, you can turn
    off zooming by de-selecting the box marked Zoom from Scenes when
    opened.













    The Only show tutorials briefly option is normally inactive. However,
    if you run the demo with this option selected, all of the timed
    Tutorials are only displayed for about 1 second regardless of the time
    duration you had specified. This is probably not enough time for the
    Tutorial to be read, but often when debugging a demo you are not
    interested in reading the Tutorials so much as seeing their relative
    placement. When the option is turned off again later, the Tutorials are
    displayed for their correct durations.

    The last three boxes on the Set Preferences dialog are radio buttons
    used to select the expertise level at which you want to operate the
    program. Essentially, this affects the number and type of warning and
    error messages you receive when running the Demo Builder. At Beginner
    level, you are warned about pretty much anything you do that could
    permanently affect the demo. Intermediate level is a little more
    forgiving and assumes you have worked with the program for a while and
    know what your doing when, for example, you replace the contents of the
    Clip Board or cut an Option. At Expert level it is assumed that you
    have mastered the program and will not make any mistakes like
    accidental deletions etc. This level is the least forgiving but you are
    harassed less often by confirmations of deletes and the like.

    Buffer Size

    The Buffer Size command (Control B) is used to get information about
    and alter the size of the buffer used to store the Macros and Tutorials
    you have created.

    A dialog shows the current buffer size, the amount of the buffer being
    used by the Tutorials and Macros you have created, the maximum size
    that the buffer can be made and the size of the Transient Program Area
    (TPA). The TPA is the amount of memory left over for the application
    program which you are demonstrating.

    By default, the buffer takes up approximately 20% of the available
    memory after the Demo Builder has loaded. To change the size of the
    buffer, simply key in the new size and click on OK. Obviously, the more
    memory you use for the buffer the less is left over for the application
    program. In any case, you are not able to make the buffer larger than
    the maximum size displayed on the dialog.

    If you are making the buffer smaller, you are not able to make it less
    than the amount of memory currently used by your Macros and Tutorials.
    This is to ensure you don't accidentaly wipe out your Scenes by
    resizing the buffer.

    When you make the buffer larger, if there are any contents in the
    buffer, they are first written out to disk. Then the old buffer's
    memory is freed up and a new larger buffer is allocated. The old buffer
    contents are then loaded into the new buffer from disk. This means that
    you must have enough free space on your working disk to store the
    Macros and Tutorials you have created. If you do not, the buffer size
    is not increased.













    The reason this is necessary is that the system memory allocation
    routines do not provide a method for increasing the size of an
    allocated block of memory. Instead you must free the old block and then
    allocate a new larger block. Decreasing the size of an allocated memory
    block is possible with the system routines so writing to disk is not
    necessary when you reduce the size of the buffer (neither is it
    necessary when you increase a buffer which has nothing in it). When you
    load a demo that requires a buffer larger than the one currently
    allocated, Demonstrator attempts to increase the size for you. If it
    fails, (i.e. there isn't enough memory) the demo won't be loaded.

    You should always keep in mind that there must be a big enough TPA for
    the application program to load even on machines that have less memory
    than yours. If there isn't, the application program won't run when you
    create Scenes or run the demo and you are just returned to the Demo
    Builder's desktop. The Demo Player module, incidentally, does not
    allocate 20% of the free memory by default, but rather allocates
    exactly what it needs to fit all the Macros and Tutorials. This coupled
    with the fact that the Demo Player is a much smaller program than the
    Demo Builder means that even though a demo may not run on a small
    machine when played via the Demo Builder, it may run if played via the
    Demo Player.

    General Startup Options

    The General Startup Options command (Control G) allows you to check for
    various hardware and software requirements that your demo may need
    before it is run.

    Each of the options on the dialog consist of a box with a question mark
    '?' followed by some other options. If the question mark is selected,
    it means that you don't care about that particular setting as it does
    not influence the running of your demo.

    When the Blitter option is set to Off it means that you want your demo
    to run without the aid of the Blitter. If the demo is running on a
    machine without a Blitter this is case anyway. However, if you are
    running on a machine with a Blitter, Demonstrator turns the Blitter off
    (if it was on) before it runs the demo. The previous setting of the
    Blitter is restored after the demo completes. If you have the Blitter
    option set to On, the demo won't run on a machine which doesn't have a
    Blitter. If the machine does have a Blitter, Demonstrator ensures that
    the Blitter is turned on before it runs the demo.

    The Resolution option, by default, is set to whichever resolution you
    are currently working in. It is unlikely that a demo created in one
    resolution will work in another so the "question mark" option is not
    selected by default. Demonstrator checks to ensure that the machine is
    in the required resolution before allowing a demo to be run otherwise
    an error message is generated.

    The GDOS option is used to determine whether GDOS is installed or not.
    Some programs require GDOS to be loaded so the Yes option should be
    selected. Those that don't require GDOS shouldn't care whether it is












    loaded or not so the ? option should be selected. However, occasionally
    a program which doesn't use GDOS won't run if it is installed. In this
    case, the No option should be selected. If GDOS is installed when it
    shouldn't be or isn't installed when it should be, an error message is
    generated and the demo won't run.

    The Mouse click option refers to how fast double clicks need to occur
    in order for GEM to recognize them as such and not interpret them as
    two separate single clicks. If your demo doesn't use double clicks very
    much you can leave this option set at ?, otherwise you should choose
    the double click speed with which the demo was created. Typically a
    setting of 4 seems reasonable but keep in mind that if you are playing
    back Macros at a reduced speed, you may have to lower the double click
    speed.

    The Minimum TPA option refers to the minimum amount of memory left over
    for the application program after the Demo Builder (or Demo Player) and
    all of the demo has been loaded. By default this option is set to ? but
    if your application program requires a large amount of memory you can
    specify a minimum memory requirement for your demo to run. To do this,
    deselect the '?' by clicking on it and the editable text field becomes
    active. By default, the minimum TPA figure is set to the amount of free
    memory currently available in your machine. To change this,replace the
    number in this field in the usual way. If an attempt is made to run the
    demo on a machine without enough memory, an error message is generated
    and the demo is cancelled.

    Keyboard Startup Options

    The Keyboard Startup Options (Control K) allow you to set the state of
    the keyboard. The Caps Lock option is the only option which isn't by
    default set to the "who cares" (i.e. ?) position. This is because it is
    almost always normal for a demo to expect the Caps Lock to be Off when
    it starts and for the demo to turn it on and off as required.

    The Key Click option determines whether or not a clicking sound is
    heard as Macros play back keystrokes.

    The ^G Bell option determines whether or not a bell sound is heard when
    programs send a Control G character to the console. This option is only
    included for the sake of completeness.

    The Key Repeat option is used to determine whether or not keys should
    be repeated when they are held down. The normal situation is to let the
    keys repeat but it is up to you to decide what is best for your demo.
    If you have key repeating On (note: if you leave it in the ? setting it
    will probably be on as well) you can optionally set the repeat delay
    rates. Begin Delay refers to the amount of time it takes after pressing
    and holding a key for the key repeating to start. Repeat Delay refers
    to the amount of time between key repeats i.e. the repeat rate.

    File Startup Options

    The File Startup Options (Control F) allow you to specify that the demo












    be run from a particular drive, type of drive and directory. It also
    allows you to check for the existance of up to 10 files in the current
    directory before proceeding to run the demo.

    As with the other startup option dialogs, you can indicate the fact
    that your demo does not need to be run from a particular drive or
    directory by selecting the ? settings for the options.

    If you want your demo to run from a particular type of disk drive,
    select either Floppy or Hard as required. You can also specify that the
    demo be run from a specific drive rather than a specific type of drive
    by selecting the letter (A through N) of the drive you want.

    Some application programs expect to be run from a specific folder. If
    this is the case for the program you are demonstrating, specify the
    full path name, starting with a B\ and not including the drive
    specifier (e.g. A:) in the space provided. Note, the path name should
    not end with a \.

    If you want, you can have your demo check to ensure that up to 10 files
    exist in the folder the demo is being run from. For example you may
    want to check that the application program's resource file is present
    and accounted for. Without it, the application program won't run
    properly and the demo appears to flail around uselessly. To specify the
    files, de-select the ? option and type in the file names in the spaces
    provided. If any of the File Startup Options criteria are not met, an
    error message is displayed and the demo is not run.

    Get Info

    The Get Info command (Control I) can be used to get information about a
    specific Macro or Tutorial or about the demo as a whole. To get info
    for a Macro or Tutorial, select the icon in question by clicking on it
    once. Now select the Get Info command from the Options menu. For
    Macros, a dialog appears informing you of how many bytes the recording
    took, the starting x,y coordinates of the mouse arrow and the number of
    times that the Macro has been placed in the Work Area.

    The dialog for Tutorials is very similar except that instead of mouse
    x,y coordinates, you are given the x,y coordinates of the top left and
    bottom right corners of the Tutorial as it would appear on the screen.
    Knowing these coordinates can come in handy when you are converting a
    demo to run in a different resolution. If Get Info is used for the
    Empty Macro or Empty Tutorial, no x,y coordinate figures is given. This
    is because the Empty Scenes don't actually exist and are merely
    placeholders. You are told, however, how many Empty Macros or Tutorials
    are placed in the Work Area. If there is no Active Tutorial Scene or
    Active Macro Scene, the Get Info command displays a dialog giving
    general information about the demo. This information includes the
    amount of memory used by Macros and Tutorials and the number and type
    of Scenes placed in the Work Area. It also indicates the maximum number
    of Macros, Tutorials and other Scenes which you can have.

    Printout













    The printout option lets you print various reports detailing
    information about the demo you have created. There are 5 different
    types of reports which can be generated. Briefly they are:

    General - This report is similar to the "Get Info for the Demo option".
    It lists the number and types of all the Scenes as well as the memory
    used by them and it also gives information on the startup and menu
    options selected for the demo.

    Demo - This report gives a textual representation of the Options and
    Scenes in the Work Area. Underneath each Scene is the setting of the
    Scene's options (e.g playback speed for Macros).

    Macros - This report gives a list of all the Macros that have been
    created along with their sizes and the x,y starting coordinates of the
    mouse. It also gives the number of times each Scene has been placed
    (this appears as a number in brackets listed after each Macro's size).

    Tutorials - This report is similar to the Macro report except that
    instead of starting mouse coordinates, the top left and bottom right
    coordinates of the Tutorial box are given.

    Tutorial Text - This report provides an unformatted listing of each
    Tutorial's text. Non-printing characters (e.g. carraige returns) are
    displayed as tildes ~.

    The Lines/Page and Characters/Line numbers default to 66 and 80
    respectively. These can be changed depending on your printer and the
    font you are using. Also a 5 character Indent is specified which
    provides a binding margin for the reports. These numbers are saved with
    the demo file so you don't have to reset them each time.

    The Printer Name field is optional and is simply a reminder what
    printer the lines/page etc., are set up for. The Printer setup string
    allows you to enter up to eight 2 digit hexadecimal numbers which are
    sent to your printer before it starts printing any reports. This can be
    used to select a different font, line spacing etc., for your printer
    through software control. For example, the LIST06.FNT provided with the
    Diablo 630 Emulator for the Atari SLM804 Laser Printer is very suitable
    for most of the reports because it is compact yet readable. In order to
    use this font however (unless it is the default font for your setup)
    you would have to send the command sequence to the laser printer
    telling it to select the correct "font slot" number for the LIST06.FNT
    font. Consult your printer's user manual for information on what hex
    codes for each of your printers features and remember that changing the
    setup for your printer may require you to alter the lines/page and
    characters/line settings also.

    The Printer reset string is similar to the setup string described above
    except that it is used to undo any settings which you may have done, so
    that your printer functions normally for other programs without you
    have to reset it. Both the Printer setup and Printer reset strings are
    saved along with the demo file so you don't have to enter them each












    time. Remember, though, that if you are working on a demo which someone
    else has created, they might have a different printer from you and the
    hex codes may be nonsense to your printer.


                                   Chapter 7

                                Hints and Ideas

    This chapter contains information about how you can get the most out of
    Demonstrator. It also describes a few pitfalls and their solutions and
    details certain requirements the application program must meet in order
    to run with Demonstrator.


                     Converting Demos to Other Resolutions

    As mentioned previously in this manual, a demo created in one screen
    resolution probably won't run in another. There are two reasons for
    this.

    Firstly, the mouse movements are relative movements based on how many
    pixels the mouse arrow moves on the screen. If the screen has less or
    more pixels vertically and horizontally then the components of the
    application program's desktop, windows, dialog boxes and menu bar are
    at different absolute screen coordinates. The Macro expects certain
    things to be in certain places and if they have moved, obiously the
    Macro won't work.

    The second reason is that Tutorials are placed on the screen at
    absolute x,y coordinates. If the screen's dimensions (in pixels) has
    decreased, then it is possible that a Tutorial may be displayed either
    partially or completely off of the screen. Also, the amount of text
    that can be written on a Tutorial is 25 lines by 80 columns in medium
    and high resolution (actually slightly less than this because of the
    Tutorial's border) and only 25 lines but 40 columns in low resolution.
    Obviously, a large Tutorial in high or medium resolution may have to
    much text to fit on the screen when in low resolution.

    Whenever Demonstrator is asked to display a tutorial which is either
    partially or completely off of the screen, it sizes the Tutorial to fit
    the whole of the current screen. This feature can be used to convert
    Tutorials from one resolution to another since the whole Tutorial (or
    as much as possible) is accessible on the screen. Simply edit the
    tutorials and resize and reposition them to fit the new resolution.

    Unfortunately, there is no similar feature available for Macros, so the
    ones that use mouse movements have to be completely re-recorded when
    you convert a demo to a new resolution.

    The best way to convert a demo from one resolution to another is to
    first print out all of the reports about the demo using the Printout
    option in the Options menu. You can then go and edit each of the
    Tutorials one by one to make sure they are located correctly on the












    screen. Next, using the Demo Printout as a guide, re-record each of the
    macros in the order in which they occur in the Work Area. The Scene and
    Option icons in the Work Area do not have to be rearranged or altered
    in any way as they remain the same from one resolution to the next.


                                 Repeatability

    The Macros created with Demonstrator have a high degree of
    repeatability when they are played back. However, there may be
    occasions when a given Macro fails to work properly when played back.
    The reason for this is that the mouse handling portions of GEM,
    especially those areas which deal with the drop down menus and the
    window scroll bars, occasionally miss mouse movements or button clicks.
    The problem is further compounded when an application program mixes the
    GEM AES and VDI mouse handling routines. A given application program
    should use either the AES (e.g. evnt_multi()) or the VDI e.g.
    (vq_mouse()) to handle the mouse, but not both. The problem is that
    some of the AES routines for handling the mouse are rather slow
    (especially on early versions of TOS) and so many applications
    developers decided to use the AES for menu, scroll bar and dialog mouse
    handling and the VDI everywhere else.

    Typical symptoms of the mouse handling problem include menus that won't
    drop down, scroll bars that won't move and the system missing or
    misinterpreting double clicks.

    If your application seems to suffer from these problems then, when
    creating Macros, click the mouse buttons everytime you move the mouse
    into the menu bar or scroller bars. This often jerks the AES into
    action and should reduce the possibilityof getting stuck menus and
    scroll bars. Make sure that all of your actions are deliberate and
    precise and ensure that your double clicks are not too near the
    double-click threshhold time.

    If this doesn't clear things up, try doing things in a slightly
    different order. For example, if you were creating a demo for a drawing
    program and a scroll bar kept getting stuck after you do a zoom in, try
    scrolling and then zooming or if that doesn't work try zooming,
    selecting some menu command and then scrolling. If you still have
    problems with a particular part of your demo, then consider alternative
    ways of accomplishing the required task that depend less on GEM e.g.
    using keyboard equivalents for drop down menu selections.

    The Macros and GEM have a high degree of repeatability and so more than
    likely you won't have any problems. If a demo runs sucessfully three or
    four times in a loop then it probably will always work, but if you have
    some difficulties then the above suggestions may be of some help.

    Another problem with repeatability concerns different versions of TOS
    and the standard GEM File Selector and Alert boxes. The problem is that
    the layout of the File Selector and Alert boxes has changed as TOS has
    evolved.













    The solution to the File Selector problem is to type the name of the
    file you want rather than using the mouse to select a name from the
    list. Also, ensure that any files you need are in the current directory
    so that you don't have to change folders or disk drives. When Alerts
    appear, try to always use the default option so that it can be selected
    by pressing return rather than using the mouse. Make sure you test your
    demos thoroughly on all versions of TOS to ensure that they will work
    no matter who is playing them.


                                 Saving Memory

    As you probably will notice fairly quickly, Macros which do a lot of
    mouse moving tend to eat up a lot of memory very quickly. There are
    several things you can do to reduce the amount of memory used by your
    Macros:

    Move as directly and quickly as possible. Obviously, moving the mouse
    around in circles before you select an item from a drop down menu
    accomplishes nothing and wastes memory. Also, by moving the mouse
    quickly, the ST/Mega Intelligent Keyboard generates less mouse packets
    to move the same distance. Using the Atari Mouse Accelerator can also
    help, but keep in mind that if you record your demo using the Mouse
    Accelerator, then whoever plays back your demo later, will have to use
    the Mouse Accelerator, also. If they don't, the Macros will not move
    far enough and the demo won't run as you intended.

    Use keyboard equivalents where possible. Most application programs have
    keyboard equivalents for some or all of their drop down menu options.
    Also, most dialogs and alerts have a default exit button which can be
    selected by pressing the Return key. You have to decide for your demo,
    whether the added continuity of a mouse moving and selecting an object
    outweighs the considerable memory savings afforded by using keyboard
    equivalents. A mixture of the two is likely to be the best solution.

    Make your macros reusable. It is often possible to use the same macro
    in several different places in a demo. Consider a demo of a drawing
    program. The demo may have to zoom in and out several times depending
    on the detail of the work being performed. It may be possible to have
    just two macros to perform all the zooming in and out for the whole
    demo. You can place the Scenes as many times as you like in the work
    area and the information for the Macros is stored only once.

    Using these basic guidelines it is possible to create relatively long
    demos (20-25 min) with a small amount of memory (60k-120k). Depending
    on the memory requirements of your application program, demos even
    larger than this can be played back on machines with as little as 512k
    bytes of memory.


                                 Caveat Emptor

    This section lists a few requirements which must be met by an
    application program in order for it to work with Demonstrator:













    The program must use the standard BIOS Intelligent Keyboard routines.
    Demonstrator patches into the BIOS at the lowest level possible but if
    your application takes over the Intelligent Keyboard completely,
    parsing its own packets and not passing anything on to TOS, then
    Demonstrator will not be able to record and play back your mouse and
    keyboard activity. This does not affect the GEM exchange mouse vector,
    exchange button change vector or any similar routines used to redirect
    mouse and keyboard processing, and they can be used normally.

    The application program should be of a repeatable, non-random nature.
    This excludes many games. As mentioned, Macros are not intelligent,
    they merely move the mouse blindly and expect things to be in the right
    place. If there is an element of randomness in your application which
    could confuse a Macro, Demonstrator is not suited for demonstrating
    your program.

    If your program intercepts the Timer C (200Hz) vector right at the mfp
    interrupt level, or the GEMDOS or BIOS trap vectors, it must re-direct
    back through the original system vector. This is required for all GEM
    programs in any case and should be no problem.

    There may be problems if your program runs exclusively in supervisor
    mode. Again, this probably only affects games. The program should
    follow all the Atari developer's guidelines and not do silly things
    like AES calls from an interrupt (assuming this could even be done). In
    particular, care should be taken when using the Line A interface from
    an interrupt context.


                                  Appendix A

                  Keystroke Combinations for Creating Scenes

    Note: In the following, the acronym CALS- means press and hold the keys
    Control, Alternate and Left Shift and then press the key following
    CALS-. The function chosen is not invoked until all of the keys in
    question have been released.


    In Play Demo mode:

    Control C  Interrupt demo (go to Create Scene mode)
    Control S  Pause demo
    Control Q  Restart demo from Pause


    In Create Scene mode:

    CALS-F1   Begin Recording Macro.
    CALS-F2   End Recording Macro.
    CALS-F3   Begin Macro Playback.
    CALS-F4   Enter Tutorial Mode
    CALS-F5   Restart Demo After ^C Interrupt














    In Tutorial Mode:

    F1  Create/Edit Tutorial
    F2  End Edit of Tutorial
    F3  Toggle Between Normal and Bold Style Text
    F4  Display Tutorial
    F5  Close Tutorial
    F10  Exit Tutorial Mode
    Help Move Tutorial Mode Menu


                                  Appendix B

                             Demoplay Instructions


                                Playing a Demo

    To play a single demo, select Play Demo... from the Demo menu (or press
    ^D). The GEM File Selector appears. Choose the name of the demo you
    want to run. The demo file does not have to be in the same folder as
    the Demo Player program, however, the application program and its
    resource and other related files must be in the same folder as the demo
    file. When you have selected the desired demo file, click on OK and the
    demonstration commences. When the demonstration is complete, you are
    returned to the Demo Player program.

    If there are any reasons the demo can't be run (e.g., wrong screen
    resolution, GDOS not installed, insufficient memory, etc.) you are
    informed of the problem(s) and the demo does not run. If possible, fix
    the problems and try again.


                            Making a Demo Play List

    You can choose to run a list of demos rather than one demo. To do this
    you must first create the list by selecting Edit List... from the List
    menu (or press ^E). A dialog appears with room for you to enter the
    names of up to eight demo files to run. Also, under each of the file
    names is a text entry field called Menu: where you can type in a
    description for the demo. It will appear on the Demo Play List menu
    (see below).

    The file names which you enter should be fully specified path names
    including drive, e.g., C:\DEMOS\MYDEMO.DMO. Instead of typing in the
    file names, it is easier to double click on the file name text entry
    field on the dialog. This brings up the GEM File Selector and you can
    select a demo.

    If you decide you don't want a particular demo in the list, select the
    appropriate file name field and press ESC to empty it. Don't worry
    about leaving blank fields in the middle of the list, the rest of the












    names will automatically be moved up when you exit the dialog.

    Loading and Saving Demo Play Lists

    Once you have created a Demo Play List, you can save it to disk so it
    can be used again later. Choose Save List... from the File menu (or
    press ^S). The GEM File Selector appears and you can save the list. The
    default extension for Demo Play Lists is .DML.

    To load a Demo Play List, use Open List... from the File menu (or press
    ^O) and choose the name from the GEM File Selector.


                            Playing a List of Demos

    Once you have either loaded or created a Demo Play List, you can run
    demos from the list. Select Play List... from the Demo menu (or press
    ^L). The Demo Play List Menu appears. The text which you entered under
    the file names appears in the list. To play a given demo, click on the
    appropriate button. If you do not choose a demo within five seconds,
    Demonstrator automatically plays the demo with the highlighted button.
    After a demo is finished, the menu appears again with the button for
    the next demo highlighted. After five seconds, it plays that demo. In
    this way, Demonstrator cycles through the entire list of demos
    automatically.

    When Demonstrator reaches the bottom of the Demo Play List, the Quit
    option is highlighted and the play list is terminated.

    Looping the Play List

    Demonstrator will replay your Demo Play List forever if you select the
    Loop option from the List menu. Selecting Loop again deselects it. A
    check mark appears next to it when Loop is selected.

    When Looping is on, Demonstrator cycles through the list of demos
    normally, and then start again at the top instead of Quitting. To
    terminate a looping play list, you must manually select Quit on the
    Demo Play List Menu.


                               Autorunning Demos

    The Demo Player program can autorun either a Demo Play List or a single
    demo. The files for the list or the demo must be in the same folder as
    DEMOPLAY.PRG. First the Demo Player looks for a Demo Play List called
    AUTODEMO.DML. If it finds the list, it plays it. If it does not find
    the list, it looks for a demo called AUTODEMO.DMO. If it finds the
    demo, it runs it. If it finds neither, it displays a GEM File Selector
    so you can choose a demo to run.


                              Exiting Demo Player













    When you have finished playing all of your demos, exit the Demo Player
    program by selecting Quit from the File menu.


























































