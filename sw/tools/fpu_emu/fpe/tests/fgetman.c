/*
 * Test:USES_FPU
 */
#include "testconfig.h"
#define TEST_OP_F_F "fgetman"
#define TEST_FUNC_F_F fpu_getman
#include "testdriver.h"



static test_f_f_data const fgetman_data[] = {
	{ __LINE__, ZERO_P, ZERO_P, 0 },
	{ __LINE__, ZERO_M, ZERO_M, 0 },
	{ __LINE__, INF_P, QNAN_P, 0 },
	{ __LINE__, INF_M, QNAN_P, 0 },
	{ __LINE__, QNAN_P, QNAN_P, 0 },
	{ __LINE__, QNAN_M, QNAN_P, 0 },
	{ __LINE__, SNAN_P, QNAN_P, 0 },
	{ __LINE__, SNAN_M, QNAN_P, 0 },

	{ __LINE__, HEXCONSTE("12.8L", 0x4002, 0xccccccccL, 0xcccccccdL), HEXCONSTE("0.8", 0x3fff, 0xccccccccL, 0xcccccccdL), 0 },
	{ __LINE__, HEXCONSTE("-27.34", 0xc003, 0xdab851ebL, 0x851eb852L), HEXCONSTE("-0.854375L", 0xbfff, 0xdab851ebL, 0x851eb852L), 0 },
	{ __LINE__, HEXCONSTE("0.25", 0x3ffd, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("0.5", 0x3ffe, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("1.0", 0x3fff, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("-1.0", 0xbfff, 0x80000000L, 0x00000000L), HEXCONSTE("-0.5", 0xbfff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("2.0", 0x4000, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("4.0", 0x4001, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("4096", 0x400b, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("-4096", 0xc00b, 0x80000000L, 0x00000000L), HEXCONSTE("-0.5", 0xbfff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("1.70141183460469231732e+38", 0x407e, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("-1.70141183460469231732e+38", 0xc07e, 0x80000000L, 0x00000000L), HEXCONSTE("-0.5", 0xbfff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("1.17549435082228750797e-38", 0x3f81, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("5.87747175411143753984e-39", 0x3f80, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("1.40129846432481707092e-45", 0x3f6a, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("-1.40129846432481707092e-45", 0xbf6a, 0x80000000L, 0x00000000L), HEXCONSTE("-0.5", 0xbfff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("8.98846567431157953865e+307", 0x43fe, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("-8.98846567431157953865e+307", 0xc3fe, 0x80000000L, 0x00000000L), HEXCONSTE("-0.5", 0xbfff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("2.22507385850720138309e-308", 0x3c01, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("1.11253692925360069155e-308", 0x3c00, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("4.94065645841246544177e-324", 0x3bcd, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("-4.94065645841246544177e-324", 0xbbcd, 0x80000000L, 0x00000000L), HEXCONSTE("-0.5", 0xbfff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("5.94865747678615882543e+4931", 0x7ffe, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("-5.94865747678615882543e+4931", 0xfffe, 0x80000000L, 0x00000000L), HEXCONSTE("-0.5", 0xbfff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("3.36210314311209350626e-4932", 0x0001, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
#if __LDBL_MIN_EXP__ <= (-16382)
	{ __LINE__, HEXCONSTE("1.68105157155604675313e-4932", 0x0000, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), FLAG_SUBNORM },
	{ __LINE__, HEXCONSTE("8.40525785778023376566e-4933", 0x0000, 0x40000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), FLAG_SUBNORM },
	{ __LINE__, HEXCONSTE("3.64519953188247460253e-4951", 0x0000, 0x00000000L, 0x00000001L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), FLAG_SUBNORM },
	{ __LINE__, HEXCONSTE("-3.64519953188247460253e-4951", 0x8000, 0x00000000L, 0x00000001L), HEXCONSTE("-0.5", 0xbfff, 0x80000000L, 0x00000000L), FLAG_SUBNORM },
#else
	{ __LINE__, HEXCONSTE("3.36210314311209350626e-4932", 0x0000, 0x80000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("1.68105157155604675313e-4932", 0x0000, 0x40000000L, 0x00000000L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("1.82259976594123730126e-4951", 0x0000, 0x00000000L, 0x00000001L), HEXCONSTE("0.5", 0x3fff, 0x80000000L, 0x00000000L), 0 },
	{ __LINE__, HEXCONSTE("-1.82259976594123730126e-4951", 0x8000, 0x00000000L, 0x00000001L), HEXCONSTE("-0.5", 0xbfff, 0x80000000L, 0x00000000L), 0 },
#endif
};

int main(int argc, char **argv)
{
	int status;
	
	status = 0;
	
	if (argc > 1)
		testonly = (int)strtol(argv[1], NULL, 0);
	
	set_precision(FPCR_PRECISION_EXTENDED);
	set_rounding(FPCR_ROUND_NEAR);
	
#ifdef TEST_OP_F_F
	status |= test_table_f_f_op(fgetman_data, ARRAY_SIZE(fgetman_data), __FILE__);
#endif
#ifdef TEST_FUNC_F_F
	status |= test_table_f_f_func(fgetman_data, ARRAY_SIZE(fgetman_data), __FILE__);
#endif
	
	return status ? EXIT_FAILURE : EXIT_SUCCESS;
}
